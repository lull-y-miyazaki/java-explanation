# 確認問題：SQLの基礎操作（SELECT / JOIN / ALTER / TRANSACTION / VIEW）

## 前提条件
- テーブル「AAA」には列 `a`（主キー）, `b`, `c` がある  
- テーブル「BBB」には列 `x`（外部キー）, `y`, `z` がある  
- 列 `x` は、`AAA.a` を参照する外部キーである  
- すべての列（`a`, `b`, `c`, `x`, `y`, `z`）は `INT` 型である  

---

## 問題1：テーブル「AAA」のすべてのレコードを表示してください（すべての列を表示）

```sql
SELECT * FROM AAA;
-- または
SELECT a, b, c FROM AAA;
```

**解説：**  
`SELECT *` は、テーブル内のすべての列を取得する基本構文です。  
列名を明示する `SELECT a, b, c` の書き方も使えます。  
テーブル全体を確認したいときに便利です。

（P33参照）

---

## 問題2：テーブル「BBB」の「y」と「z」列だけを表示してください。

```sql
SELECT y, z FROM BBB;
```

**解説：**  
必要な列をカンマで区切って指定し、最小限のデータだけを取り出す方法です。  
すべての列が必要ない場合は、こうして限定するのが効率的です。

（P33参照）

---

## 問題3：テーブル「AAA」と「BBB」を内部結合して、「b」「c」「y」「z」を表示してください。

```sql
SELECT aaa.b, aaa.c, bbb.y, bbb.z
FROM AAA aaa
INNER JOIN BBB bbb
ON aaa.a = bbb.x;
```

**解説：**  
`INNER JOIN` を使って2つのテーブルを `aaa.a = bbb.x` で結合します。  
両方のテーブルに一致するデータのみを取得します。  
エイリアス（aaa, bbb）を使うことで列の特定がしやすくなります。

（P79〜参照）

---

## 問題4：テーブル「BBB」の列名「x」を「a」に変更してください。

```sql
-- MySQLの場合
ALTER TABLE BBB CHANGE x a INT;

-- PostgreSQLなどの場合
ALTER TABLE BBB RENAME COLUMN x TO a;
```

**解説：**  
`ALTER TABLE` はテーブル構造を変更するための構文です。  
MySQLでは `CHANGE`、PostgreSQLでは `RENAME COLUMN` を使います。  
列の名前変更は、他のSQLと整合性を保つためにも重要です。

---

## 問題5：「問題4」の変更を反映し、「b」「c」「y」「z」を内部結合して表示してください。

```sql
SELECT aaa.b, aaa.c, bbb.y, bbb.z
FROM AAA aaa
INNER JOIN BBB bbb
USING(a);
```

**解説：**  
`USING(a)` は、両方のテーブルで同名の列があるときに使える簡略構文です。  
`ON aaa.a = bbb.a` と同じ意味ですが、コードがすっきりします。  
内部結合の記法の一つとして覚えておくと便利です。

（P79〜参照）

---

## 問題6：トランザクション処理を開始するSQL文を記述してください。

```sql
START TRANSACTION;
```

**解説：**  
`START TRANSACTION` は、複数の処理をひとまとめにして実行する準備をするコマンドです。  
これにより、途中で問題が起きた場合にまとめて取り消せるようになります。

（P126〜参照）

---

## 問題7：トランザクション処理を確定するSQL文を記述してください。

```sql
COMMIT;
```

**解説：**  
`COMMIT` を実行すると、トランザクション内の処理が正式に保存されます。  
この操作を行うまでは、データベースには確定されていません。

（P126〜参照）

---

## 問題8：トランザクション処理を元に戻すSQL文を記述してください。

```sql
ROLLBACK;
```

**解説：**  
`ROLLBACK` は、トランザクション内の変更をすべてなかったことにします。  
失敗した操作を取り消して、もとの状態に戻すことができます。

（P126〜参照）

---

## 問題9：トランザクション中に停電でシステムが止まった場合、処理は確定される？  
回答：✕（ロールバックされる）

**解説：**  
トランザクションは `COMMIT` をしていない限り、正式には確定されません。  
停電などでシステムが落ちた場合、途中までの変更はすべて自動的に取り消されます。  
これを「ロールバック」といいます。

（P126〜参照）

---

## 問題10：「問題5」のSELECT結果をビューとして保存してください（ビュー名は「xyz」）

```sql
CREATE VIEW xyz AS
SELECT aaa.b, aaa.c, bbb.y, bbb.z
FROM AAA aaa
INNER JOIN BBB bbb
USING(a);
```

**解説：**  
`CREATE VIEW` を使うと、SELECT文の結果を「仮想的なテーブル」として保存できます。  
ビューは再利用可能で、元のデータが更新されればビューの内容も更新されます。  
複雑なJOINや条件がある場合に特に便利です。

---
